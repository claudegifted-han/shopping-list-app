# 프롬프트 튜닝 가이드

## 개요

DJSHS AI 에이전트의 응답 품질을 개선하기 위한 프롬프트 튜닝 가이드입니다.

---

## 1. 프롬프트 구조 이해

### 1.1 시스템 프롬프트 위치

```
dshs-ai-agents/
└── prompts/
    └── system/
        ├── academic_affairs.md    # 교무운영부
        ├── gifted_edu.md          # 영재교육부
        ├── evaluation.md          # 교육평가부
        ├── brainstorm.md          # 브레인스토밍
        └── ...                    # 기타 에이전트
```

### 1.2 프롬프트 기본 구조

```markdown
# [부서명] AI 부장 시스템 프롬프트

당신은 대전과학고등학교 [부서명] AI 부장입니다.

## 역할 및 정체성
- [역할 1]
- [역할 2]

## 담당 업무
1. [업무 1]
2. [업무 2]

## 핵심 역량
- [역량 1]
- [역량 2]

## 출력 형식
```출력 템플릿```

## 협업 규칙
- [규칙 1]
- [규칙 2]

## 응답 스타일
- [스타일 1]
- [스타일 2]
```

---

## 2. 튜닝 원칙

### 2.1 기본 원칙

| 원칙 | 설명 |
|------|------|
| 명확성 | 모호한 표현 제거, 구체적 지시 |
| 일관성 | 동일 상황에서 동일 응답 패턴 |
| 실용성 | 실제 업무에 즉시 활용 가능 |
| 안전성 | 보안 규칙 명시 및 준수 |

### 2.2 피해야 할 것

```
❌ 너무 긴 프롬프트 (토큰 낭비)
❌ 모순되는 지시
❌ 과도한 제약 (유연성 저하)
❌ 불명확한 출력 형식
```

### 2.3 권장 사항

```
✅ 역할과 정체성 명확히 정의
✅ 구체적인 출력 형식 제시
✅ 예시 포함 (few-shot)
✅ 보안 규칙 명시
✅ 협업 부서 및 역할 경계 명시
```

---

## 3. 튜닝 프로세스

### 3.1 문제 식별

**피드백 수집 채널:**
- 사용자 직접 피드백
- 테스트 결과 분석
- 사용 로그 분석

**문제 유형 분류:**

| 유형 | 증상 | 원인 |
|------|------|------|
| 형식 오류 | 출력 형식 불일치 | 템플릿 미비 |
| 내용 오류 | 잘못된 정보 | 지식 부족 |
| 범위 오류 | 역할 외 응답 | 경계 미정의 |
| 보안 위반 | 민감정보 노출 | 규칙 미비 |

### 3.2 분석 및 수정

**1. 현재 프롬프트 분석**

```bash
# 프롬프트 파일 확인
cat prompts/system/[agent_name].md
```

**2. 문제 구간 식별**

- 역할 정의 문제 → `## 역할 및 정체성` 수정
- 출력 형식 문제 → `## 출력 형식` 수정
- 범위 문제 → `## 담당 업무` 수정
- 보안 문제 → `## 보안 규칙` 추가/수정

**3. 수정 적용**

```bash
# 프롬프트 수정
vim prompts/system/[agent_name].md

# 변경사항 저장 및 커밋
git add prompts/system/[agent_name].md
git commit -m "fix: [agent] 프롬프트 개선 - [변경내용]"
```

### 3.3 테스트

**테스트 시나리오 실행:**

```
@[부서명] [테스트 명령]
```

**검증 항목:**
- [ ] 출력 형식 정확
- [ ] 내용 적절
- [ ] 역할 범위 준수
- [ ] 보안 규칙 준수

### 3.4 배포

```bash
# 변경사항 푸시
git push origin main

# 적용 확인
@[부서명] 테스트 명령
```

---

## 4. 에이전트별 튜닝 가이드

### 4.1 교무운영부

**핵심 튜닝 포인트:**
- 공문 형식 표준화
- 회의록 템플릿 일관성
- 격식 문체 유지

**자주 발생하는 문제:**

| 문제 | 해결 |
|------|------|
| 문서번호 형식 오류 | 형식 예시 추가 |
| 비격식 문체 | 응답 스타일 강화 |
| 누락된 항목 | 필수 항목 체크리스트 추가 |

**개선 예시:**

```markdown
# Before
## 출력 형식
공문 형식으로 작성

# After
## 출력 형식
### 공문 템플릿
```
문서번호: 대전과학고-YYYY-MMDD-NNN
수    신: [수신처]
제    목: [제목]

1. 관련: [관련 근거]
2. [본문 내용]

                          대전과학고등학교장
```
※ 모든 공문은 위 형식을 준수
```

### 4.2 영재교육부

**핵심 튜닝 포인트:**
- 자율연구 팀 조직 형식
- NEIS 기재문 글자 수 제한
- 연구 일정 정확성

**자주 발생하는 문제:**

| 문제 | 해결 |
|------|------|
| NEIS 글자 수 초과 | 글자 수 제한 명시 |
| 분야 불균형 | 균형 배분 규칙 추가 |
| 일정 오류 | 학사일정 참조 지시 |

### 4.3 교육평가부

**핵심 튜닝 포인트:**
- 통계량 계산 정확성
- 분석 소견 실용성
- 보안 규칙 철저

**자주 발생하는 문제:**

| 문제 | 해결 |
|------|------|
| 계산 오류 | 계산 공식 명시 |
| 과도한 해석 | 객관적 서술 지시 |
| 개인정보 노출 | 보안 규칙 강화 |

### 4.4 브레인스토밍

**핵심 튜닝 포인트:**
- 다양한 관점 균형
- 리스크 분석 충실
- 실행 가능한 권고안

**자주 발생하는 문제:**

| 문제 | 해결 |
|------|------|
| 편향된 분석 | 균형 지시 강화 |
| 비현실적 제안 | 실현 가능성 검토 지시 |
| 부서 누락 | 최소 부서 수 명시 |

---

## 5. 공통 튜닝 패턴

### 5.1 출력 형식 개선

**Before:**
```markdown
## 출력 형식
적절한 형식으로 작성
```

**After:**
```markdown
## 출력 형식

### 보고서 형식
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
       [보고서 제목]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

작성일: YYYY-MM-DD
작성자: [부서명]

【1. 현황】
[내용]

【2. 분석】
[내용]

【3. 권고】
[내용]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```
```

### 5.2 보안 규칙 추가

```markdown
## 보안 규칙

### 접근 불가 정보
- 개별 학생 성적
- 입학전형 비공개 정보
- 상담 기록
- 교원 인사 정보

### 요청 거부 시 응답
```
⚠️ 보안 알림

해당 정보는 [보안등급] 데이터로 AI 시스템을 통한
직접 조회가 제한됩니다.

정당한 절차:
- [절차 안내]

문의: [담당 부서]
```
```

### 5.3 협업 규칙 명시

```markdown
## 협업 규칙

### 연계 부서
| 업무 | 연계 부서 |
|------|----------|
| [업무1] | [부서1] |
| [업무2] | [부서2] |

### 역할 경계
- 본 부서 담당: [목록]
- 타 부서 이관: [목록]
```

---

## 6. 버전 관리

### 6.1 프롬프트 버전 기록

각 프롬프트 파일 상단에 버전 정보 기록:

```markdown
---
version: 1.2
updated: 2026-02-01
changes:
  - 1.2: 출력 형식 개선
  - 1.1: 보안 규칙 추가
  - 1.0: 초기 버전
---
```

### 6.2 변경 이력 관리

```bash
# 커밋 메시지 형식
git commit -m "prompt([agent]): [변경 내용]

- 변경 사항 1
- 변경 사항 2

Closes #[이슈번호]"
```

---

## 7. 튜닝 체크리스트

```
□ 문제 정확히 식별
□ 원인 분석 완료
□ 프롬프트 수정
□ 로컬 테스트 통과
□ 사이드 이펙트 확인
□ 변경사항 커밋
□ 문서 업데이트
□ 배포 후 확인
```

---

## 문의

- 프롬프트 튜닝: 교육연구부 (042-863-7815)
- 기술 지원: 교육정보부 (042-863-7810)
